import React, { useEffect } from 'react';
import { X } from 'lucide-react';
import { Button } from '../../components';

interface PrivacyModalProps {
    isOpen: boolean;
    onClose: () => void;
}

const PrivacyModal: React.FC<PrivacyModalProps> = ({ isOpen, onClose }) => {
    useEffect(() => {
        if (isOpen) {
            document.body.classList.add('overflow-hidden');
        } else {
            document.body.classList.remove('overflow-hidden');
        }

        return () => {
            document.body.classList.remove('overflow-hidden');
        };
    }, [isOpen]);

    if (!isOpen) return null;

    return (
        <div className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
            <div className="bg-white rounded-xl shadow-2xl max-w-3xl w-full max-h-[80vh] overflow-y-auto">
                <div className="sticky top-0 bg-white border-b px-6 py-4 flex items-center justify-between">
                    <h3 className="text-lg font-semibold">GoServePH Data Privacy Policy</h3>
                    <button
                        type="button"
                        onClick={onClose}
                        className="text-gray-500 hover:text-gray-700"
                    >
                        <X size={20} />
                    </button>
                </div>
                
                <div className="px-6 py-4 space-y-4 text-sm leading-6">
                    <p><strong>Protecting the information you and your users handle through our system is our highest priority.</strong> This policy outlines how Urban Planning manages, secures, and uses your data.</p>
                    
                    <h4 className="font-semibold">1. How We Define and Use Data</h4>
                    <p>In this policy, we define the types of data that flow through the Urban Planning system:</p>
                    <table className="w-full text-left text-xs">
                        <thead>
                            <tr><th className="py-1 pr-4">Term</th><th className="py-1">Definition</th></tr>
                        </thead>
                        <tbody>
                            <tr><td className="py-1 pr-4">Personal Data</td><td className="py-1">Any information that can identify a specific person, whether directly or indirectly, shared or accessible through the Services.</td></tr>
                            <tr><td className="py-1 pr-4">User Data</td><td className="py-1">Information that describes your business operations, services, or internal activities.</td></tr>
                            <tr><td className="py-1 pr-4">Urban Planning Data</td><td className="py-1">Details about transactions and activity on our platform, information used for fraud detection, aggregated data, and any non-personal information generated by our system.</td></tr>
                            <tr><td className="py-1 pr-4">DATA</td><td className="py-1">Used broadly to refer to all the above: Personal Data, User Data, and Urban Planning Data.</td></tr>
                        </tbody>
                    </table>
                    
                    <h4 className="font-semibold">Our Commitment to Data Use</h4>
                    <p>We analyze and manage data only for the following critical purposes:</p>
                    <ul className="list-disc pl-5">
                        <li>To provide, maintain, and improve the Urban Planning Services for you and all other users.</li>
                        <li>To detect and mitigate fraud, financial loss, or other harm to you or other users.</li>
                        <li>To develop and enhance our products, systems, and tools.</li>
                    </ul>
                    <p>We will not sell or share Personal Data with unaffiliated parties for their marketing purposes. By using our system, you consent to our use of your Data in this manner.</p>
                    
                    <h4 className="font-semibold">2. Data Protection and Compliance</h4>
                    <p><strong>Confidentiality</strong></p>
                    <p>We commit to using Data only as permitted by our agreement or as specifically directed by you. You, in turn, must protect all Data you access through Urban Planning and use it only in connection with our Services. Neither party may use Personal Data to market to third parties without explicit consent.</p>
                    <p>We will only disclose Data when legally required to do so, such as through a subpoena, court order, or search warrant.</p>
                    
                    <p><strong>Privacy Compliance and Responsibilities</strong></p>
                    <p><em>Your Legal Duty:</em> You affirm that you are, and will remain, compliant with all applicable Philippine laws (including the Data Privacy Act of 2012) governing the collection, protection, and use of the Data you provide to us.</p>
                    <p><em>Consent:</em> You are responsible for obtaining all necessary rights and consents from your End-Users to allow us to collect, use, and store their Personal Data.</p>
                    <p><em>End-User Disclosure:</em> You must clearly inform your End-Users that Urban Planning processes transactions for you and may receive their Personal Data as part of that process.</p>
                    
                    <p><strong>Data Processing Roles</strong></p>
                    <p>When we process Personal Data on your behalf, we operate under the following legal roles:</p>
                    <ul className="list-disc pl-5">
                        <li>You are the Data Controller (you determine why and how the data is processed).</li>
                        <li>We are the Data Intermediary (we process data strictly according to your instructions).</li>
                    </ul>
                    <p>As the Data Intermediary, we commit to:</p>
                    <ul className="list-disc pl-5">
                        <li>Implementing appropriate security measures to protect the Personal Data we process.</li>
                        <li>Not retaining Personal Data longer than necessary to fulfill the purposes set out in our agreement.</li>
                    </ul>
                    <p>You acknowledge that we rely entirely on your instructions. Therefore, we are not liable for any claims resulting from our actions that were based directly or indirectly on your instructions.</p>
                    
                    <p><strong>Prohibited Activities</strong></p>
                    <p>You are strictly prohibited from data mining the Urban Planning database or any portion of it without our express written permission.</p>
                    
                    <p><strong>Breach Notification</strong></p>
                    <p>If we become aware of an unauthorized acquisition, disclosure, change, or loss of Personal Data on our systems (a "Breach"), we will notify you and provide sufficient information to help you mitigate any negative impact, consistent with our legal obligations.</p>
                    
                    <h4 className="font-semibold">3. Account Deactivation and Data Deletion</h4>
                    <p><strong>Initiating Deactivation</strong></p>
                    <p>If you wish to remove your personal information from our systems, you must go to your Edit Profile page and click the 'Deactivate Account' button. This action initiates the data deletion and account deactivation process.</p>
                    
                    <p><strong>Data Retention</strong></p>
                    <p>Upon deactivation, all of your Personal Identifying Information will be deleted from our systems.</p>
                    <p><em>Important Note:</em> Due to the nature of our role as a Government Services Management System, and for legal, accounting, and audit purposes, we are required to retain some of your non-personal account activity history and transactional records. You will receive a confirmation email once your request has been fully processed.</p>
                    
                    <h4 className="font-semibold">4. Security Controls and Responsibilities</h4>
                    <p><strong>Our Security</strong></p>
                    <p>We are responsible for implementing commercially reasonable administrative, technical, and physical procedures to protect Data from unauthorized access, loss, or modification. We comply with all applicable Laws in handling Data.</p>
                    
                    <p><strong>Your Security Controls</strong></p>
                    <p>You acknowledge that no security system is perfect. You agree to implement your own necessary security measures ("Security Controls"), which must include:</p>
                    <ul className="list-disc pl-5">
                        <li>Firewall and anti-virus systems.</li>
                        <li>Anti-phishing systems.</li>
                        <li>End-User and device management policies.</li>
                        <li>Data handling protocols.</li>
                    </ul>
                    <p>We reserve the right to suspend your Account or the Services if necessary to maintain system integrity and security, or to prevent harm. You waive any right to claim losses that result from a Breach or any action we take to prevent harm.</p>
                </div>
                
                <div className="border-t px-6 py-3 flex justify-end">
                    <Button
                        type="button"
                        onClick={onClose}
                        className="px-4 py-2 rounded-lg bg-secondary text-white"
                    >
                        Close
                    </Button>
                </div>
            </div>
        </div>
    );
};

export default PrivacyModal;
